#| label: fig-comparing-graphics-figures
#| fig-cap: "Four different representations of COVID vaccination rates."
#| fig-subcap: ["Caption 1", "Caption 2", "Caption 3", "Caption 4"]
#| fig-alt: ["Alt 1", "Alt 2", "Alt 3", "Alt 4"]
#| layout-ncol: 2
#| code-fold: true
# Load required libraries
suppressPackageStartupMessages({
library(ggplot2)
theme_set(theme_bw())
library(dplyr)
library(tidyr)
})
# Create sample dataset
set.seed(123)
weeks <- 1:12
age_groups <- c("18-29", "30-49", "50-64", "65+")
# Generate vaccination rate data with realistic patterns
vaccination_data <- data.frame(
week = rep(weeks, each = 4),
age_group = rep(age_groups, times = 12),
vaccination_rate = c(
# Week-by-week data for each age group
12, 18, 25, 35,  # Week 1
15, 22, 30, 41,  # Week 2
18, 26, 35, 47,  # Week 3
22, 31, 41, 54,  # Week 4
26, 36, 47, 60,  # Week 5
30, 41, 53, 66,  # Week 6
34, 46, 58, 71,  # Week 7
38, 50, 63, 75,  # Week 8
42, 54, 67, 79,  # Week 9
45, 58, 71, 82,  # Week 10
48, 61, 74, 85,  # Week 11
51, 64, 77, 87   # Week 12
)
)
# Set factor levels for consistent ordering
vaccination_data$age_group <- factor(vaccination_data$age_group,
levels = c("18-29", "30-49", "50-64", "65+"))
# Define color palette
age_colors <- c("18-29" = "#FF6B6B",
"30-49" = "#4ECDC4",
"50-64" = "#FFD93D",
"65+" = "#95E1D3")
# CHART A: 3D Pie Chart (showing total vaccinations by age group)
# Calculate total vaccinations per age group (sum across weeks)
total_by_age <- vaccination_data %>%
group_by(age_group) %>%
summarise(total = sum(vaccination_rate))
# Create pie chart with 3D-like appearance using custom positioning
chart_a <- ggplot(total_by_age, aes(x = "", y = total, fill = age_group)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar("y", start = 0) +
scale_fill_manual(values = age_colors) +
labs(title = "Chart A: 3D Pie Chart - Total Vaccinations by Age Group",
subtitle = "(Summed across all 12 weeks)",
fill = "Age Group") +
theme_void() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10, face = "italic"),
legend.position = "right",
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10)
) +
# Add percentage labels
geom_text(aes(label = paste0(round(total/sum(total)*100, 1), "%")),
position = position_stack(vjust = 0.5),
size = 4, fontface = "bold")
# CHART B: Line Graph - Vaccination Rates Over Time
chart_b <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
# CHART C: Stacked Area Chart - Vaccination Rates Over Time
chart_c <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
fill = age_group)) +
geom_area(alpha = 0.8, position = "stack") +
scale_fill_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart C: Stacked Area Chart - Vaccination Rates Over Time",
x = "Week",
y = "Cumulative Vaccination Rate (%)",
fill = "Age Group")
# CHART D: Grouped Bar Chart - Vaccination Rates by Week and Age Group
chart_d <- ggplot(vaccination_data, aes(x = factor(week), y = vaccination_rate,
fill = age_group)) +
geom_bar(stat = "identity", position = "dodge", width = 0.8) +
scale_fill_manual(values = age_colors) +
labs(title = "Chart D: Grouped Bar Chart - Vaccination Rates by Week and Age Group",
x = "Week",
y = "Vaccination Rate (%)",
fill = "Age Group")
chart_a
chart_b
chart_c
chart_d
#| label: fig-comparing-graphics-figures
#| fig-cap: "Four different representations of COVID vaccination rates."
#| fig-subcap: ["People over 50 make up the majority of vaccinations.", "Vaccination rates increase over the measured 12 weeks.", "Vaccination rates have increased over the 12 week period", "Younger people are less vacinated than older people but all age groups have increased vaccinations over the 12 week period"]
#| fig-alt: ["Pie Chart showing the percentage of vaccinations that each age group made up in proportion to total vaccinations.", "Line graph with a line for each age group. The x axis is each week 1 - 12 and the y axis is the percentage of vaccinations for that age group.", "Stacked area chart whith 4 areas colored in different colors for each age group. The x axis is the weeks plotted 1-12 and the y axis is the cumulative vaccination rate", "Grouped bar chart where age group is separated into 4 different colored bars for the 4 age groups for each point on the x axis. The x axis represents the weeks 1 - 12 and the y axis is the percent vaccination rate for that age group."]
#| layout-ncol: 2
#| code-fold: true
# Load required libraries
suppressPackageStartupMessages({
library(ggplot2)
theme_set(theme_bw())
library(dplyr)
library(tidyr)
})
# Create sample dataset
set.seed(123)
weeks <- 1:12
age_groups <- c("18-29", "30-49", "50-64", "65+")
# Generate vaccination rate data with realistic patterns
vaccination_data <- data.frame(
week = rep(weeks, each = 4),
age_group = rep(age_groups, times = 12),
vaccination_rate = c(
# Week-by-week data for each age group
12, 18, 25, 35,  # Week 1
15, 22, 30, 41,  # Week 2
18, 26, 35, 47,  # Week 3
22, 31, 41, 54,  # Week 4
26, 36, 47, 60,  # Week 5
30, 41, 53, 66,  # Week 6
34, 46, 58, 71,  # Week 7
38, 50, 63, 75,  # Week 8
42, 54, 67, 79,  # Week 9
45, 58, 71, 82,  # Week 10
48, 61, 74, 85,  # Week 11
51, 64, 77, 87   # Week 12
)
)
# Set factor levels for consistent ordering
vaccination_data$age_group <- factor(vaccination_data$age_group,
levels = c("18-29", "30-49", "50-64", "65+"))
# Define color palette
age_colors <- c("18-29" = "#FF6B6B",
"30-49" = "#4ECDC4",
"50-64" = "#FFD93D",
"65+" = "#95E1D3")
# CHART A: 3D Pie Chart (showing total vaccinations by age group)
# Calculate total vaccinations per age group (sum across weeks)
total_by_age <- vaccination_data %>%
group_by(age_group) %>%
summarise(total = sum(vaccination_rate))
# Create pie chart with 3D-like appearance using custom positioning
chart_a <- ggplot(total_by_age, aes(x = "", y = total, fill = age_group)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar("y", start = 0) +
scale_fill_manual(values = age_colors) +
labs(title = "Chart A: 3D Pie Chart - Total Vaccinations by Age Group",
subtitle = "(Summed across all 12 weeks)",
fill = "Age Group") +
theme_void() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10, face = "italic"),
legend.position = "right",
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10)
) +
# Add percentage labels
geom_text(aes(label = paste0(round(total/sum(total)*100, 1), "%")),
position = position_stack(vjust = 0.5),
size = 4, fontface = "bold")
# CHART B: Line Graph - Vaccination Rates Over Time
chart_b <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
# CHART C: Stacked Area Chart - Vaccination Rates Over Time
chart_c <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
fill = age_group)) +
geom_area(alpha = 0.8, position = "stack") +
scale_fill_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart C: Stacked Area Chart - Vaccination Rates Over Time",
x = "Week",
y = "Cumulative Vaccination Rate (%)",
fill = "Age Group")
# CHART D: Grouped Bar Chart - Vaccination Rates by Week and Age Group
chart_d <- ggplot(vaccination_data, aes(x = factor(week), y = vaccination_rate,
fill = age_group)) +
geom_bar(stat = "identity", position = "dodge", width = 0.8) +
scale_fill_manual(values = age_colors) +
labs(title = "Chart D: Grouped Bar Chart - Vaccination Rates by Week and Age Group",
x = "Week",
y = "Vaccination Rate (%)",
fill = "Age Group")
chart_a
chart_b
chart_c
chart_d
View(vaccination_data)
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages")
View(vaccination_data_total)
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages") %>%
distinct()
View(vaccination_data_total)
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
vaccination_data <- rbind(vaccination_data, vaccination_data_total)
chart_b <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
vaccination_data <- rbind(vaccination_data, vaccination_data_total)
chart_e <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
chart_e
View(total_by_age)
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
vaccination_data <- rbind(vaccination_data, vaccination_data_total)
chart_e <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
chart_e
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
vaccination_data <- rbind(vaccination_data, vaccination_data_total)
age_colors <- c("18-29" = "#FF6B6B",
"30-49" = "#4ECDC4",
"50-64" = "#FFD93D",
"65+" = "#95E1D3",
"All Ages Avg" = "tan")
chart_e <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
chart_e
ages <- readxl::read_xlsx("nc-est2024-agesex.xlsx")
View(ages)
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
#| label: fig-comparing-graphics-figures
#| fig-cap: "Four different representations of COVID vaccination rates."
#| fig-subcap: ["People over 50 make up the majority of vaccinations.", "Vaccination rates increase over the measured 12 weeks.", "Vaccination rates have increased over the 12 week period", "Younger people are less vacinated than older people but all age groups have increased vaccinations over the 12 week period"]
#| fig-alt: ["Pie Chart showing the percentage of vaccinations that each age group made up in proportion to total vaccinations.", "Line graph with a line for each age group. The x axis is each week 1 - 12 and the y axis is the percentage of vaccinations for that age group.", "Stacked area chart whith 4 areas colored in different colors for each age group. The x axis is the weeks plotted 1-12 and the y axis is the cumulative vaccination rate", "Grouped bar chart where age group is separated into 4 different colored bars for the 4 age groups for each point on the x axis. The x axis represents the weeks 1 - 12 and the y axis is the percent vaccination rate for that age group."]
#| layout-ncol: 2
#| code-fold: true
# Load required libraries
suppressPackageStartupMessages({
library(ggplot2)
theme_set(theme_bw())
library(dplyr)
library(tidyr)
})
# Create sample dataset
set.seed(123)
weeks <- 1:12
age_groups <- c("18-29", "30-49", "50-64", "65+")
# Generate vaccination rate data with realistic patterns
vaccination_data <- data.frame(
week = rep(weeks, each = 4),
age_group = rep(age_groups, times = 12),
vaccination_rate = c(
# Week-by-week data for each age group
12, 18, 25, 35,  # Week 1
15, 22, 30, 41,  # Week 2
18, 26, 35, 47,  # Week 3
22, 31, 41, 54,  # Week 4
26, 36, 47, 60,  # Week 5
30, 41, 53, 66,  # Week 6
34, 46, 58, 71,  # Week 7
38, 50, 63, 75,  # Week 8
42, 54, 67, 79,  # Week 9
45, 58, 71, 82,  # Week 10
48, 61, 74, 85,  # Week 11
51, 64, 77, 87   # Week 12
)
)
# Set factor levels for consistent ordering
vaccination_data$age_group <- factor(vaccination_data$age_group,
levels = c("18-29", "30-49", "50-64", "65+"))
# Define color palette
age_colors <- c("18-29" = "#FF6B6B",
"30-49" = "#4ECDC4",
"50-64" = "#FFD93D",
"65+" = "#95E1D3")
# CHART A: 3D Pie Chart (showing total vaccinations by age group)
# Calculate total vaccinations per age group (sum across weeks)
total_by_age <- vaccination_data %>%
group_by(age_group) %>%
summarise(total = sum(vaccination_rate))
# Create pie chart with 3D-like appearance using custom positioning
chart_a <- ggplot(total_by_age, aes(x = "", y = total, fill = age_group)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar("y", start = 0) +
scale_fill_manual(values = age_colors) +
labs(title = "Chart A: 3D Pie Chart - Total Vaccinations by Age Group",
subtitle = "(Summed across all 12 weeks)",
fill = "Age Group") +
theme_void() +
theme(
plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, size = 10, face = "italic"),
legend.position = "right",
legend.title = element_text(size = 11, face = "bold"),
legend.text = element_text(size = 10)
) +
# Add percentage labels
geom_text(aes(label = paste0(round(total/sum(total)*100, 1), "%")),
position = position_stack(vjust = 0.5),
size = 4, fontface = "bold")
# CHART B: Line Graph - Vaccination Rates Over Time
chart_b <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
# CHART C: Stacked Area Chart - Vaccination Rates Over Time
chart_c <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
fill = age_group)) +
geom_area(alpha = 0.8, position = "stack") +
scale_fill_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart C: Stacked Area Chart - Vaccination Rates Over Time",
x = "Week",
y = "Cumulative Vaccination Rate (%)",
fill = "Age Group")
# CHART D: Grouped Bar Chart - Vaccination Rates by Week and Age Group
chart_d <- ggplot(vaccination_data, aes(x = factor(week), y = vaccination_rate,
fill = age_group)) +
geom_bar(stat = "identity", position = "dodge", width = 0.8) +
scale_fill_manual(values = age_colors) +
labs(title = "Chart D: Grouped Bar Chart - Vaccination Rates by Week and Age Group",
x = "Week",
y = "Vaccination Rate (%)",
fill = "Age Group")
chart_a
chart_b
chart_c
chart_d
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
vaccination_data <- rbind(vaccination_data, vaccination_data_total)
age_colors <- c("18-29" = "gray",
"30-49" = "orange",
"50-64" = "blue",
"65+" = "black",
"All Ages Avg" = "tan")
chart_e <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
chart_e
vaccination_data_total <- vaccination_data %>%
group_by(week) %>%
mutate(vaccination_rate = mean(vaccination_rate)) %>%
mutate(age_group = "All Ages Avg") %>%
distinct()
vaccination_data <- rbind(vaccination_data, vaccination_data_total)
age_colors <- c("18-29" = "gray",
"30-49" = "orange",
"50-64" = "blue",
"65+" = "black",
"All Ages Avg" = "red")
chart_e <- ggplot(vaccination_data, aes(x = week, y = vaccination_rate,
color = age_group, group = age_group)) +
geom_line(linewidth = 1.2) +
geom_point(size = 2.5) +
scale_color_manual(values = age_colors) +
scale_x_continuous(breaks = 1:12) +
labs(title = "Chart B: Line Graph - Vaccination Rates Over Time",
x = "Week",
y = "Vaccination Rate (%)",
color = "Age Group")
chart_e
ages <- readxl::read_xlsx("nc-est2024-agesex.xlsx")
vaccs <- read.csv("Weekly_Cumulative_Estimated_Number_of_COVID-19_Vaccinations_Administered_in_Pharmacies_and_Physician_Medical_Offices,_Adults_18_years_and_older,_by_Season_and_Age_Group,_United_States_20251021.csv")
ages <- readxl::read_xlsx("nc-est2024-agesex.xlsx")
vaccs <- read.csv("Weekly_Cumulative_Estimated_20251021.csv")
